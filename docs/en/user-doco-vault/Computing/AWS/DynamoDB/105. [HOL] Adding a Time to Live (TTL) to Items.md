#course/aws/developer-associate 

Hi guys, in this lesson we're going to add a [[Time To Live (TTL)|Time to Live]] attribute to items in our database and we're going to see how we can then use that to automatically expire those items. 

So I'm back in this file here. We do need to recreate our table. So what I'm going to do is create my table and then we're going to run this command. So I'm just going to copy the command to my clipboard. I've come back to Amazon DynamoDB. Let's create the table. We're going to create it with the same settings as we've had before. So it's called My Store. Partition key is client ID. And the sort key is created. And then I'm just going to accept all defaults and create my table. So my table is active and I've come back to the command line. And I'll just paste in that command again. And we're going to add all of those items to our table. 

So if I go back into my table now and choose explore items, I can see all the items as I could before. Now what we're going to do is we're going to add an attribute to these items. So for example, let's choose one of these items and I'm going to add an attribute. Now, it must be a number. And we're going to call it expiry. You can call this whatever you want, but I'm going to call mine expiry. Now, the actual value associated with this is going to be based on the UNIX epoch time. 

So let's have a look at what that is. So if I go to a browser window and search for epochs time converter, I'm going to use this UNIX.timestamp.com. Now, what you'll see is it actually comes up with this value, this is the current time in the UNIX epoch time format. And that's actually the number of seconds since January the 1st 1970. Now here, we can see where we can actually create our own values, so we can specify a time and it will convert it to the UNIX epoch time. Now the current epoch time translates to UTC. Now I know that my table is using UTC-4 because it's in North Virginia. So essentially I can take four hours off of this to make it the current time in UTC minus four. So here we have the hour set to 20, so let's change that to 16. click on convert. And what we're going to have is a UNIX timestamp that is 15 minutes ahead of the DynamoDB table. So I'm going to copy that. 

Let's paste this in. Click on save changes. Then let's add another one. This time we'll change the time to 1730, so that's now about an hour and 15 minutes ahead and click on convert. Take this timestamp, copy it. Let's come back. We'll search or we'll open another user's item. Add number, type expiry, and then paste in our UNIX epoch time. And then click on save changes. So we've now got two expiry items here. So these are TTLs, we're going to use these as TTLs at least. One should be 15 minutes ahead, one should be around about an hour and 15 minutes ahead. If I now click on update table settings and go to additional settings, we can see Time to Live. So here you can enable Time to Live or you can just run a preview. So for example, I put in the expiry attribute name, and then I can specify to simulate the next 60 minutes. So what's going to expire in the next 60 minutes? Well, we've got one item that's going to expire in the next 60 minutes because we added the expiry which was 15 minutes ahead of current time. If I then change it to next 24 hours, we should now have two. So we now know that if we specify a TTL attribute name of expiry in the table, so we would do that here by enabling our attributes. So let's put in expiry. 

And now enabled TTL. It will then expire those items. Now note that it does say it can take up to one hour to be applied across all partitions. So let's click on enable TTL and that's going to be put into place. So the TTL is now going to automatically expire those items when the timestamp is reached. 

So a practical use for the TTL would be in a DynamoDB table where perhaps you're storing something like session state data. So you might not want to expire orders from your table in this ecommerce store. But if you had session state data that only had a limited usefulness so it's only relevant for a period of hours or days, then the TTL is a way of removing those items from the database when you no longer need them. And it does so cost efficiently. It doesn't cost you anything to do this. 

Whereas if you are scanning or querying, that does incur cost. So that's it for this lesson. I hope you enjoyed it and I'll see you in the next one. 

----

What are two benefits of using DynamoDB TTL
?
(1) Saves implementation time
(2) Is cost effective in that there is no fee for using this method of deleting stale data
<!--SR:!2024-08-06,54,250-->

What format are DynamoDB TTL timestamps required::Unix epoch times, with time zone of the region in which the DynamoDB table is kept
<!--SR:!2024-07-28,45,250-->
